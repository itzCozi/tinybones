---
import { getCollection } from "astro:content";
import BaseLayout from "@/layouts/BaseLayout.astro";
import Snippets from "@/components/Snippets.astro";
import SeoPage from "@/components/SeoPage.astro";

export async function getStaticPaths() {
  const allSnippets = (await getCollection("snippets")).filter((s) => !s.data.draft);
  const pageSize = 5;
  const totalPages = Math.ceil(allSnippets.length / pageSize);

  const paths = [];
  for (let i = 2; i <= totalPages; i++) {
    paths.push({
      params: { page: i.toString() },
      props: { currentPage: i, totalPages },
    });
  }

  return paths;
}

const { currentPage } = Astro.props;
---

<BaseLayout>
  <SeoPage
    slot="head"
    title={`Snippets - pg${currentPage}`}
  />
  <Snippets
    {currentPage}
    showPagination={true}
    baseUrl="/snippets"
  />
</BaseLayout>
