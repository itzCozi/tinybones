---
import { ClientRouter } from "astro:transitions";

import { SITE } from "@/siteConfig";

import Favicons from "@/components/Favicons.astro";
---

<head>
  <script is:inline>
    (function () {
      var root = document.documentElement;
      root.classList.add("js");
      try {
        var theme = localStorage.getItem("currentTheme") || "system";
        var prefersDark = window.matchMedia("(prefers-color-scheme: dark)").matches;
        var isDark = theme === "dark" || (theme === "system" && prefersDark);
        if (isDark) {
          root.classList.add("dark");
          root.classList.remove("light");
        } else {
          root.classList.add("light");
          root.classList.remove("dark");
        }
      } catch (e) {}
    })();
  </script>
  <meta charset="UTF-8" />
  <meta
    http-equiv="X-UA-Compatible"
    content="IE=edge"
  />
  <meta
    name="HandheldFriendly"
    content="True"
  />
  <meta
    name="format-detection"
    content="telephone=no"
  />
  <meta
    name="referrer"
    content="no-referrer-when-downgrade"
  />
  <meta
    name="viewport"
    content="width=device-width, initial-scale=1.0, user-scalable=yes"
  />
  <meta
    name="generator"
    content={Astro.generator}
  />
  <meta
    name="theme-color"
    content="#fff"
    media="(prefers-color-scheme: light)"
  />
  <meta
    name="theme-color"
    content="#000"
    media="(prefers-color-scheme: dark)"
  />

  <link
    rel="preconnect"
    href="https://fonts.googleapis.com"
  />
  <link
    rel="preconnect"
    href="https://fonts.gstatic.com"
    crossorigin
  />
  <link
    rel="sitemap"
    href="/sitemap-index.xml"
  />
  <link
    rel="manifest"
    href="/site.webmanifest"
  />
  <link
    rel="alternate"
    type="application/rss+xml"
    title={SITE.title}
    href={new URL("rss.xml", Astro.site)}
  />

  <ClientRouter />
  <Favicons />

  <script
    is:inline
    type="application/ld+json"
    set:html={JSON.stringify({
      "@context": "https://schema.org",
      "@type": "WebSite",
      name: SITE.title,
      url: SITE.href,
      potentialAction: {
        "@type": "SearchAction",
        target: `${SITE.href}search?q={search_term_string}`,
        "query-input": "required name=search_term_string",
      },
    })}
  />

  <slot />
</head>
